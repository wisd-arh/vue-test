!function(t){function e(e){for(var n,c,a=e[0],s=e[1],u=e[2],p=0,d=[];p<a.length;p++)c=a[p],Object.prototype.hasOwnProperty.call(i,c)&&i[c]&&d.push(i[c][0]),i[c]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n]);for(l&&l(e);d.length;)d.shift()();return o.push.apply(o,u||[]),r()}function r(){for(var t,e=0;e<o.length;e++){for(var r=o[e],n=!0,a=1;a<r.length;a++){var s=r[a];0!==i[s]&&(n=!1)}n&&(o.splice(e--,1),t=c(c.s=r[0]))}return t}var n={},i={2:0},o=[];function c(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.m=t,c.c=n,c.d=function(t,e,r){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},c.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)c.d(r,n,function(e){return t[e]}.bind(null,n));return r},c.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/";var a=window.webpackJsonp=window.webpackJsonp||[],s=a.push.bind(a);a.push=e,a=a.slice();for(var u=0;u<a.length;u++)e(a[u]);var l=s;o.push([58,3]),r()}({58:function(t,e,r){"use strict";r.r(e);var n=r(7),i=r.n(n),o=r(6),c=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"catalog-wrapper"},[t.goods?r("div",{staticClass:"table"},t._l(t.catalogGroups,(function(e,n){return r("div",{key:n,staticClass:"group-container"},[r("div",{staticClass:"group-title"},[r("div",{staticClass:"group-title__icon",on:{click:function(r){return t.toggleGroup(e[0])}}},[r("svg",{class:{hidden:t.isHidden(e[0])}},[r("use",{attrs:{href:"icons/icons.svg#arrow-down"}})])]),r("div",{staticClass:"group-title__title"},[t._v(t._s(t.groupTitle(e[0])))])]),r("div",{directives:[{name:"show",rawName:"v-show",value:!t.isHidden(e[0]),expression:"!isHidden(group[0])"}],staticClass:"items"},t._l(e[1],(function(i){return r("div",{key:n+"/"+i.T,staticClass:"item-container",class:{"price-down":t.priceDown(i.T),"price-up":t.priceUp(i.T)}},[r("div",{staticClass:"item-title",on:{click:function(r){return t.appendItem({groupId:e[0],itemId:i.T})}}},[t._v(t._s(t.itemTitle(e[0],i.T)+"("+i.P+")"))]),r("div",{staticClass:"item-price"},[t._v(t._s(t.price(i.C)))])])})),0)])})),0):t._e(),r("div",{staticClass:"course"},[r("div",{staticClass:"course-title"},[t._v("Курс USD")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.course,expression:"course"}],attrs:{type:"number",min:"20",max:"80"},domProps:{value:t.course},on:{input:function(e){e.target.composing||(t.course=e.target.value)}}})]),r("div",{staticClass:"last-update"},[t._v(t._s("Обновлено: "+t.lastUpdate))]),r("cart",{attrs:{course:t.course}})],1)};c._withStripped=!0;var a=r(3),s=r.n(a),u=r(2),l=r.n(u),p=r(1),d=r.n(p),f=r(0),m=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"cart-wrapper"},[r("div",{staticClass:"cart-title"},[t._v("Корзина")]),r("div",{staticClass:"cart"},[t._m(0),t._l(t.items,(function(e,n){return r("cart-item",{key:n,attrs:{item:e,course:t.course}})}))],2),r("div",{staticClass:"cart-total"},[r("span",[t._v("Общая стоимость:")]),r("div",{staticClass:"cart-total__total"},[t._v(t._s(t.totalPrice)+" руб.")])])])};m._withStripped=!0;var v=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"cart-item"},[r("div",{staticClass:"cart-item__title"},[t._v(t._s(t.groupTitle(t.item.groupId)+". "+t.itemTitle(t.item.groupId,t.item.itemId)))]),r("div",{staticClass:"cart-item__count"},[r("div",{staticClass:"cart-item__count-input"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.localCount,expression:"localCount"}],attrs:{type:"number",min:"1"},domProps:{value:t.localCount},on:{input:function(e){e.target.composing||(t.localCount=e.target.value)}}}),r("span",[t._v("шт.")])]),r("div",{directives:[{name:"show",rawName:"v-show",value:t.itemLimit(t.item.itemId),expression:"itemLimit(item.itemId)"}],staticClass:"cart-item__count-attention"},[t._v("Количество ограничено")])]),r("div",{staticClass:"cart-item__price"},[r("div",{staticClass:"cart-item__price-price"},[t._v(t._s(t.price)+" руб.")]),r("span",[t._v("/ шт.")])]),r("div",{staticClass:"cart-item__remove"},[r("a",{staticClass:"cart-item__remove-button",on:{click:function(e){return e.preventDefault(),t.removeItem(t.item)}}},[t._v("Удалить")])])])};function b(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function g(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?b(Object(r),!0).forEach((function(e){l()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}v._withStripped=!0;var h={name:"CartItem",props:["item","course"],computed:g(g(g({},Object(f.c)("db",["groupTitle","itemTitle"])),Object(f.c)("catalog",["itemLimit","itemPrice"])),{},{localCount:{get:function(){return this.item.count},set:function(t){t>0&&this.updateItemCount(g(g({},this.item),{},{newCount:t}))}},price:function(){return(this.itemPrice(this.item.itemId)*this.course*this.localCount).toFixed(2)}}),methods:g({},Object(f.b)("cart",["updateItemCount","removeItem"]))},O=r(4),w=Object(O.a)(h,v,[],!1,null,null,null);function _(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function y(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?_(Object(r),!0).forEach((function(e){l()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}w.options.__file="src/vue/cart/cart-item.vue";var j={name:"Cart",components:{cartItem:w.exports},props:["course"],computed:y(y(y({},Object(f.c)("cart",{items:"getItems"})),Object(f.c)("catalog",["itemPrice"])),{},{totalPrice:function(){var t=this;return this.items.reduce((function(e,r){return e+=r.count*t.itemPrice(r.itemId)*t.course}),0).toFixed(2)}})},P=Object(O.a)(j,m,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"cart-header"},[e("div",{staticClass:"column"},[this._v("Наименование товара и описание")]),e("div",{staticClass:"column"},[this._v("Количество")]),e("div",{staticClass:"column"},[this._v("Цена")]),e("div",{staticClass:"column"})])}],!1,null,null,null);function C(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function I(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?C(Object(r),!0).forEach((function(e){l()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}P.options.__file="src/vue/cart/layout.vue";var x={name:"App",components:{cart:P.exports},data:function(){return{hiddenGroups:[],course:20,lastUpdate:"",prices:{}}},methods:I(I(I(I({},Object(f.b)("db",["loadDb"])),Object(f.b)("catalog",["loadGoods"])),Object(f.b)("cart",["appendItem"])),{},{startTimer:function(){var t=this;return s()(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:setInterval(s()(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.loadGoods();case 2:t.checkPrices(),t.lastUpdate=new Date;case 4:case"end":return e.stop()}}),e)}))),15e3);case 1:case"end":return e.stop()}}),e)})))()},toggleGroup:function(t){this.hiddenGroups.includes(t)?this.hiddenGroups=this.hiddenGroups.filter((function(e){return e!==t})):this.hiddenGroups.push(t)},checkPrices:function(){var t=this;this.goods.forEach((function(e){t.prices[e.T]||(t.prices[e.T]={newPrice:0,oldPrice:0}),t.prices[e.T].oldPrice=t.prices[e.T].newPrice,t.prices[e.T].newPrice=e.C*t.course}))}}),computed:I(I(I({},Object(f.c)("catalog",{goods:"getGoods",goodsByGroup:"getGoodsByGroup"})),Object(f.c)("db",["groupTitle","itemTitle"])),{},{catalogGroups:function(){return Object.entries(this.goodsByGroup)},isHidden:function(){var t=this;return function(e){return t.hiddenGroups.includes(e)}},price:function(){var t=this;return function(e){return(e*t.course).toFixed(2)}},priceDown:function(){var t=this;return function(e){return!!t.prices[e]&&t.prices[e].newPrice<t.prices[e].oldPrice}},priceUp:function(){var t=this;return function(e){return!!t.prices[e]&&t.prices[e].newPrice>t.prices[e].oldPrice}}}),created:function(){var t=this;return s()(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.loadDb();case 2:return e.next=4,t.loadGoods();case 4:t.checkPrices(),t.checkPrices(),t.lastUpdate=new Date,t.startTimer();case 8:case"end":return e.stop()}}),e)})))()}},G=Object(O.a)(x,c,[],!1,null,"084e7aec",null);G.options.__file="src/vue/layout.vue";var k=G.exports,D="./names.json",T="./data.json",S=5,E={namespaced:!0,state:{data:null},getters:{getData:function(t){return t.data},getGoods:function(t){return t.data?t.data.Value.Goods:[]},getGoodsByGroup:function(t){return t.data?t.data.Value.Goods.reduce((function(t,e,r){return t[e.G]||(t[e.G]=[]),t[e.G].push(e),t}),{}):{}},itemLimit:function(t){return function(e){if(t.data&&t.data.Value&&t.data.Value.Goods){var r=t.data.Value.Goods.find((function(t){return t.T===e}));if(r)return parseFloat(r.P)<S}return!1}},itemPrice:function(t){return function(e){if(t.data&&t.data.Value&&t.data.Value.Goods){var r=t.data.Value.Goods.find((function(t){return t.T===e}));if(r)return parseFloat(r.C)}return 0}}},actions:{loadGoods:function(t){return s()(d.a.mark((function e(){var r,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(T);case 3:if(!(r=e.sent).ok){e.next=11;break}return e.next=7,r.json();case 7:n=e.sent,t.commit("setData",n),e.next=12;break;case 11:throw"Network error";case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),alert("Файл данных поврежден или недоступен."),console.log(e.t0.message);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))()}},mutations:{setData:function(t,e){t.data=e}}};function V(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function N(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?V(Object(r),!0).forEach((function(e){l()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var U={namespaced:!0,state:{items:[]},getters:{getItems:function(t){return t.items||[]}},actions:{appendItem:function(t,e){t.state.items.find((function(t){return t.groupId===e.groupId&&t.itemId===e.itemId}))?alert("Товар уже в корзине"):(t.commit("addItem",N(N({},e),{},{count:1})),alert("Добавлен в корзину"))},updateItemCount:function(t,e){var r=t.state.items.map((function(t){return t.groupId===e.groupId&&t.itemId===e.itemId&&(t.count=e.newCount),t}));t.commit("setItems",r)},removeItem:function(t,e){var r=t.state.items.filter((function(t){return!(t.groupId===e.groupId&&t.itemId===e.itemId)}));t.commit("setItems",r)}},mutations:{setItems:function(t,e){t.items=e},addItem:function(t,e){t.items.push(e)}}},B={namespaced:!0,state:{db:null},getters:{getDb:function(t){return t.db},groupTitle:function(t){return function(e){return t.db&&t.db[e]&&t.db[e].G?t.db[e].G:"Group undefined"}},itemTitle:function(t){return function(e,r){return t.db&&t.db[e]&&t.db[e].B&&t.db[e].B[r].N||"undefined item"}}},actions:{loadDb:function(t){return s()(d.a.mark((function e(){var r,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(D);case 3:if(!(r=e.sent).ok){e.next=11;break}return e.next=7,r.json();case 7:n=e.sent,t.commit("setDb",n),e.next=12;break;case 11:throw"Network error";case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),alert("Файл базы данных поврежден или недоступен."),console.log(e.t0.message);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))()}},mutations:{setDb:function(t,e){t.db=e}}};o.a.use(f.a);var F=new f.a.Store({modules:{catalog:E,cart:U,db:B}}),H=document.querySelector("#app");H&&new function t(e){i()(this,t),new o.a({el:e,store:F,render:function(t){return t(k)}})}(H)}});